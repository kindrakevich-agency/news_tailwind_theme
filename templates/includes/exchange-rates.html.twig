{#
/**
 * @file
 * Theme implementation for exchange rates block.
 *
 * Available variables:
 * - exchange_rates: Array of exchange rates with currency codes and rates.
 */
#}
{% if exchange_rates %}
<div class="border-t border-b md:border-0 border-gray-200 mb-6 md:mb-0">
    <div class="max-w-7xl mx-auto md:px-4 lg:px-8">
        <div id="exchange-rates-scroll" class="flex items-center h-12 overflow-x-auto scrollbar-hide md:border-t md:border-b md:border-gray-200 cursor-pointer md:cursor-default">
            <div id="exchange-rates-content" class="flex items-center space-x-8 whitespace-nowrap pl-4 md:pl-0">
                {% for currency_code, rate_data in exchange_rates %}
                    <div class="text-base text-gray-600">
                        <span class="font-medium text-gray-900">{{ currency_code }}</span>
                        <span class="mx-1">â†’</span>
                        <span class="text-teal-600 font-semibold">{{ rate_data.rate }} UAH</span>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    const scrollContainer = document.getElementById('exchange-rates-scroll');
    const scrollContent = document.getElementById('exchange-rates-content');

    if (!scrollContainer || !scrollContent) return;

    let isScrolling = true;
    let scrollPosition = 0;
    let scrollSpeed = 0.5; // pixels per frame
    let animationFrame = null;

    // Check if we're on mobile
    const isMobile = () => window.innerWidth < 768;

    function autoScroll() {
        if (!isScrolling) return;

        scrollPosition += scrollSpeed;

        // Reset scroll position when we reach the end
        const maxScroll = scrollContent.scrollWidth - scrollContainer.clientWidth;
        if (scrollPosition >= maxScroll) {
            scrollPosition = 0;
        }

        scrollContainer.scrollLeft = scrollPosition;
        animationFrame = requestAnimationFrame(autoScroll);
    }

    function startScroll() {
        if (isScrolling) return;
        isScrolling = true;
        autoScroll();
    }

    function stopScroll() {
        isScrolling = false;
        if (animationFrame) {
            cancelAnimationFrame(animationFrame);
            animationFrame = null;
        }
    }

    // Desktop: pause on hover
    if (!isMobile()) {
        scrollContainer.addEventListener('mouseenter', stopScroll);
        scrollContainer.addEventListener('mouseleave', startScroll);

        // Start auto-scroll on desktop
        startScroll();
    } else {
        // Mobile: toggle on click
        scrollContainer.addEventListener('click', function() {
            if (isScrolling) {
                stopScroll();
            } else {
                startScroll();
            }
        });
    }

    // Handle window resize
    let resizeTimeout;
    window.addEventListener('resize', function() {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(function() {
            stopScroll();
            scrollPosition = 0;
            scrollContainer.scrollLeft = 0;

            // Restart on desktop after resize
            if (!isMobile()) {
                startScroll();
            }
        }, 250);
    });
})();
</script>
{% endif %}
